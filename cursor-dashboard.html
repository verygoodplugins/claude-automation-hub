<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Integration - Cursor Dashboard</title>
    <style>
      body {
        font-family: -apple-system, system-ui, sans-serif;
        max-width: 900px;
        margin: 40px auto;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      .container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }
      h1 {
        color: #333;
        border-bottom: 3px solid #667eea;
        padding-bottom: 10px;
      }
      .status {
        padding: 10px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .status.connected {
        background: #d4edda;
        color: #155724;
      }
      .status.error {
        background: #f8d7da;
        color: #721c24;
      }
      .task {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .task h3 {
        margin: 0 0 10px 0;
        color: #333;
      }
      .task p {
        color: #666;
        margin: 5px 0;
      }
      a.cursor-link {
        display: inline-block;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        text-decoration: none;
        padding: 10px 20px;
        border-radius: 6px;
        font-weight: 600;
        margin: 10px 10px 0 0;
        transition: transform 0.2s;
      }
      a.cursor-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }
      .loading {
        color: #666;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üöÄ AI Integration Tasks - Cursor Deep Links</h1>

      <div id="status" class="status">Checking proxy connection...</div>

      <div id="tasks">
        <div class="loading">Loading tasks...</div>
      </div>
    </div>

    <script>
      const PROXY_URL = "http://localhost:8765";

      const tasks = [
        {
          id: "claude-automation-hub-env",
          projectPath: "/Users/jgarturo/Projects/OpenAI/claude-automation-hub",
          file: "README.md",
          title: "üìù Claude Hub .env Documentation",
          description:
            "Add comprehensive .env setup documentation with security best practices",
          prompt:
            "Add a comprehensive section about .env file setup and security best practices...",
        },
        {
          id: "stormlight-refactor",
          projectPath: "/Users/jgarturo/Projects/OpenAI/stormlight_short",
          file: "MULTI_PROJECT_REFACTOR_PLAN.md",
          title: "üé¨ Stormlight Multi-Project Architecture",
          description: "Implement the multi-project refactoring plan",
          prompt:
            "Implement the multi-project architecture as outlined in this refactor plan...",
        },
        {
          id: "stormlight-veo3",
          projectPath: "/Users/jgarturo/Projects/OpenAI/stormlight_short",
          file: "studio.py",
          title: "üé• Veo3 Prompt Optimization",
          description: "Update Veo3 prompts based on Twitter recommendations",
          prompt:
            "Update Veo3 video generation prompts based on recommendations...",
        },
        {
          id: "mcp-reloader",
          projectPath: "/Users/jgarturo/Projects/OpenAI",
          title: "üîÑ MCP Auto-Reloader Setup",
          description:
            "Set up mcp-reloader for auto-reloading during development",
          prompt:
            "Set up https://github.com/mizchi/mcp-reloader for auto-reloading MCP servers...",
        },
        {
          id: "freescout-github",
          projectPath: "/Users/jgarturo/Projects/OpenAI/freescout-github",
          title: "üé´ FreeScout-GitHub Integration",
          description: "Review and enhance the ticket-to-PR workflow",
          prompt: "Review and enhance the FreeScout-GitHub integration...",
        },
      ];

      async function checkProxy() {
        const statusEl = document.getElementById("status");
        try {
          const response = await fetch(PROXY_URL + "/health");
          const data = await response.json();
          statusEl.className = "status connected";
          statusEl.textContent = `‚úÖ Connected to Cursor Web Proxy (${data.tasks} tasks registered)`;
          return true;
        } catch (error) {
          statusEl.className = "status error";
          statusEl.innerHTML =
            "‚ùå Proxy not running. Run: <code>npm run proxy</code> in claude-automation-hub";
          return false;
        }
      }

      async function registerAndDisplay() {
        const container = document.getElementById("tasks");
        const isConnected = await checkProxy();

        if (!isConnected) {
          container.innerHTML =
            "<p>Please start the proxy server to generate links.</p>";
          return;
        }

        container.innerHTML = "";

        for (const task of tasks) {
          // Register task
          try {
            const response = await fetch(PROXY_URL + "/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(task),
            });

            const result = await response.json();

            // Create task element
            const taskEl = document.createElement("div");
            taskEl.className = "task";
            taskEl.innerHTML = `
                        <h3>${task.title}</h3>
                        <p>${task.description}</p>
                        <p style="font-size: 0.9em; color: #999;">
                            ${
                              task.file
                                ? `üìÑ ${task.file}`
                                : `üìÅ ${task.projectPath.split("/").pop()}`
                            }
                        </p>
                        ${
                          result.success
                            ? `<a href="${result.url}" class="cursor-link" target="_blank">Open in Cursor ‚Üí</a>`
                            : '<span style="color: red;">Failed to create link</span>'
                        }
                    `;
            container.appendChild(taskEl);
          } catch (error) {
            console.error("Failed to register task:", task.id, error);
          }
        }
      }

      // Initialize on load
      registerAndDisplay();
    </script>
  </body>
</html>
